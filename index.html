<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>확률과 통계 수업 대시보드</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NK7JXGN417"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-NK7JXGN417');
  </script>
  <style>
    /* 폰트: 한국어 가독성 강화 */
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;800&family=Inter:wght@500;600;700;800;900&display=swap');

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      font-family: 'Noto Sans KR','Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:#1f2937;
      font-size:16px; line-height:1.6; letter-spacing:-.01em;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      min-height:100vh;
      position: relative;
    }

    /* 배경 패턴 추가 */
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="%23ffffff" opacity="0.05"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>') repeat;
      pointer-events: none;
      z-index: -1;
    }

    h1,h2,h3,h4{line-height:1.35;margin-bottom:.5rem;font-weight:800}
    h1{font-size:2rem} h2{font-size:1.5rem} h3{font-size:1.25rem} h4{font-size:1.125rem}

    /* 헤더 */
    .header-gradient{
      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #ec4899 100%);
      box-shadow: 0 20px 40px rgba(79,70,229,.3), 0 0 0 1px rgba(255,255,255,.1) inset;
      border-radius: 20px; 
      color: white;
      position: relative;
      overflow: hidden;
    }
    
    .header-gradient::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: radial-gradient(circle at 30% 40%, rgba(255,255,255,0.1) 0%, transparent 50%);
      pointer-events: none;
    }
    
    .header-content {
      position: relative;
      z-index: 1;
    }

    /* 액션 타일 */
    .action-tile{
      border-radius: 20px; 
      padding: 32px; 
      color: #fff; 
      width: 100%;
      box-shadow: 0 10px 30px rgba(0,0,0,.2), 0 0 0 1px rgba(255,255,255,.1) inset;
      transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative; 
      overflow: hidden; 
      text-align: center; 
      cursor: pointer; 
      border: 0;
      outline: none;
      backdrop-filter: blur(10px);
    }
    
    .action-tile::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(135deg, rgba(255,255,255,.1) 0%, transparent 50%);
      opacity: 0;
      transition: opacity .3s ease;
    }
    
    .action-tile:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 50px rgba(0,0,0,.3), 0 0 0 1px rgba(255,255,255,.2) inset;
    }
    
    .action-tile:hover::before {
      opacity: 1;
    }
    
    .action-tile h3 {
      font-size: 1.5rem;
      margin-bottom: 8px;
      font-weight: 800;
    }
    
    .action-tile p {
      font-size: 1rem;
      opacity: 0.9;
      font-weight: 500;
    }
    
    /* 그리드 라인 숨김 */
    .grid {
      border: none;
      outline: none;
    }
    .tile-blue{background:linear-gradient(135deg,#3b82f6 0%,#6366f1 100%)}
    .tile-green{background:linear-gradient(135deg,#10b981 0%,#059669 100%)}
    .tile-purple{background:linear-gradient(135deg,#8b5cf6 0%,#a855f7 100%)}
    .tile-orange{background:linear-gradient(135deg,#f59e0b 0%,#f97316 100%)}
    .tile-indigo{background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%)}

    /* 카드 공통 */
    .card{
      background: rgba(255,255,255,.95); 
      backdrop-filter: blur(10px);
      border-radius: 20px; 
      padding: 32px;
      box-shadow: 0 8px 32px rgba(0,0,0,.1), 0 0 0 1px rgba(255,255,255,.2) inset;
      border: 1px solid rgba(255,255,255,.3);
      transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(135deg, rgba(255,255,255,.1) 0%, transparent 50%);
      opacity: 0;
      transition: opacity .3s ease;
      pointer-events: none;
    }
    
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 50px rgba(0,0,0,.15), 0 0 0 1px rgba(255,255,255,.3) inset;
    }
    
    .card:hover::before {
      opacity: 1;
    }

    /* 검색바 */
    .search-container{
      background: rgba(255,255,255,.95); 
      backdrop-filter: blur(10px);
      border-radius: 50px; 
      padding: 16px 24px;
      box-shadow: 0 8px 32px rgba(0,0,0,.1), 0 0 0 1px rgba(255,255,255,.2) inset;
      border: 1px solid rgba(255,255,255,.3);
      transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    
    .search-container:focus-within {
      transform: translateY(-2px);
      box-shadow: 0 16px 50px rgba(0,0,0,.15), 0 0 0 1px rgba(79,70,229,.3) inset;
      border-color: rgba(79,70,229,.5);
    }
    
    .search-input {
      border: none; 
      outline: none; 
      width: 100%; 
      background: transparent; 
      font-size: 16px; 
      color: inherit;
      font-weight: 500;
    }
    
    .search-input::placeholder {
      color: #9ca3af;
      font-weight: 400;
    }

    /* 다크모드 스타일 */
    body.dark {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #e5e7eb;
    }
    
    body.dark .card {
      background: #1f2937;
      border-color: rgba(255,255,255,.1);
      color: #e5e7eb;
    }
    
    body.dark .search-container {
      background: #1f2937;
      color: #e5e7eb;
    }
    
    body.dark .search-input::placeholder {
      color: #9ca3af;
    }
    
    body.dark .iframe-modal {
      background: #1f2937;
      color: #e5e7eb;
    }
    
    body.dark .iframe-header {
      border-bottom-color: #374151;
    }
    
    /* 테마 토글 버튼 */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 999;
      background: rgba(255,255,255,0.9);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    
    .theme-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }
    
    body.dark .theme-toggle {
      background: rgba(31,41,55,0.9);
      color: #e5e7eb;
    }

    /* ===== 인-모드 iframe 모달 =====
       깜빡임 방지: display 고정, visibility/opacity 전환 + 스크롤 잠금시 padding-right 보정 */
    .iframe-container{
      position: fixed; inset: 0; z-index: 1000;
      background: rgba(0,0,0,0.6);
      padding: 24px;
      display: block;             /* 항상 DOM 상주 */
      visibility: hidden;         /* 보이기/숨김만 토글 */
      opacity: 0;
      transition: opacity .25s ease, visibility .25s ease;
    }
    .iframe-container.is-open{
      visibility: visible;
      opacity: 1;
    }
    .iframe-modal{
      background:#fff; color:#111827; border-radius:14px;
      box-shadow:0 25px 70px rgba(0,0,0,.3);
      width:100%; height:100%;
      display:flex; flex-direction:column;
    }
    .iframe-header{
      display:flex; align-items:center; justify-content:space-between;
      padding:12px 16px; border-bottom:1px solid #e5e7eb;
    }
    .iframe-title{font-weight:800; font-size:18px; margin:0;}
    .iframe-actions{display:flex; gap:8px; align-items:center;}
    .btn-primary{
      background:#4f46e5; color:#fff; border:none; border-radius:8px;
      padding:8px 12px; font-weight:700; cursor:pointer;
    }
    .btn-primary:hover{filter:brightness(1.05)}
    .btn-close{
      border:none; background:transparent; font-size:28px; line-height:1; cursor:pointer; color:#6b7280;
    }
    .btn-close:hover{ color:#111827; }
    .iframe-body{flex:1;}
    .iframe-body iframe{width:100%; height:100%; border:0; border-radius:0 0 14px 14px;}

    /* 상단 이동 버튼 */
    .scroll-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 998;
      background: rgba(79,70,229,0.9);
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transition: all 0.3s ease;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    
    .scroll-to-top:hover {
      transform: scale(1.1);
      background: rgba(79,70,229,1);
    }
    
    .scroll-to-top.visible {
      display: flex;
    }

    /* 모바일 최적화 개선 */
    @media (max-width: 768px) {
      body {
        padding: 10px;
        overflow-x: hidden;
      }
      
      .max-w-7xl {
        padding: 0 10px;
      }
      
      /* 액션 타일 그리드를 모바일에서 1열로 */
      .grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3 {
        grid-template-columns: 1fr !important;
        gap: 16px;
      }
      
      /* 액션 타일 터치 영역 확대 */
      .action-tile {
        min-height: 120px;
        padding: 24px;
        font-size: 16px;
      }
      
      .action-tile h3 {
        font-size: 1.3rem;
      }
      
      /* 평가 방법 카드 모바일 최적화 */
      .grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3 {
        grid-template-columns: 1fr !important;
      }
      
      /* 시험 정보 카드 간격 조정 */
      .grid.grid-cols-1.md\\:grid-cols-2 {
        grid-template-columns: 1fr !important;
        gap: 20px;
      }
      
      /* 텍스트 가독성 향상 */
      .card {
        padding: 20px;
        margin: 0 5px;
      }
      
      /* 헤더 텍스트 조정 */
      .header h1 {
        font-size: 2.5rem !important;
        line-height: 1.2;
        margin-bottom: 16px;
      }
      
      .header p {
        font-size: 1.1rem !important;
      }
      
      /* 검색바 모바일 최적화 */
      .search-container {
        margin: 0 5px 20px 5px;
        padding: 16px 20px;
      }
      
      .search-input {
        font-size: 16px; /* iOS 줌 방지 */
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 5px;
      }
      
      .max-w-7xl {
        padding: 0 5px;
      }
      
      .header {
        padding: 20px 15px;
        margin-bottom: 15px;
      }
      
      .header h1 {
        font-size: 2rem !important;
      }
      
      .header p {
        font-size: 1rem !important;
      }
      
      .card {
        padding: 16px;
        margin: 0 2px;
      }
      
      .action-tile {
        min-height: 100px;
        padding: 20px;
      }
      
      .action-tile h3 {
        font-size: 1.2rem;
      }
      
      .action-tile p {
        font-size: 0.9rem;
      }
      
      /* 상단 이동 버튼 위치 조정 */
      .scroll-to-top {
        bottom: 15px;
        right: 15px;
        width: 45px;
        height: 45px;
      }
      
      /* 테마 토글 버튼 위치 조정 */
      .theme-toggle {
        top: 15px;
        right: 15px;
        width: 45px;
        height: 45px;
      }
    }

    /* 모션 감소 선호 */
    @media (prefers-reduced-motion: reduce){
      .iframe-container{transition:none}
      .search-container{transition:none}
      .action-tile{transition:none}
      .card{transition:none}
      .scroll-to-top{transition:none}
    }
  </style>
</head>
<body>

  <!-- 다크모드 토글 버튼 -->
  <button id="themeToggle" class="theme-toggle" aria-label="테마 변경">
    🌙
  </button>

  <!-- 상단 이동 버튼 -->
  <button id="scrollToTop" class="scroll-to-top" aria-label="상단으로 이동">
    ↑
  </button>

  <div class="max-w-7xl mx-auto p-6">
         <!-- 헤더 -->
     <header class="header-gradient p-8 mb-8">
       <div class="header-content flex flex-col gap-6">
         <div class="text-center">
           <div class="text-6xl mb-4">📊</div>
           <h1 class="text-4xl md:text-5xl font-black bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent">확률과 통계</h1>
           <p class="text-xl text-blue-100 font-medium mt-3 opacity-90">2025년 2학기</p>
           <div class="mt-6 flex flex-wrap justify-center items-center gap-3 text-sm">
             <div class="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full border border-white/30 flex items-center gap-2">
               <span class="text-lg">👨‍🏫</span>
               <span class="font-medium">박도영</span>
             </div>
             <div class="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full border border-white/30 flex items-center gap-2">
               <span class="text-lg">📚</span>
               <span class="font-medium">수학</span>
             </div>
             <div class="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full border border-white/30 flex items-center gap-2">
               <span class="text-lg">⏰</span>
               <span class="font-medium">3시간</span>
             </div>
             <div class="bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full border border-white/30 flex items-center gap-2">
               <span class="text-lg">🏫</span>
               <span class="font-medium">2-6교실</span>
             </div>
           </div>
         </div>
         
         <!-- 버튼들을 세로로 정렬 -->
         <div class="flex flex-col sm:flex-row gap-4">
           <!-- 전체 시간표 보기 버튼 -->
           <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20">
             <div class="text-center">
               <button onclick="handleViewSchedule()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors font-semibold">
                 📅 전체 시간표 보기 →
               </button>
             </div>
           </div>
           
           <!-- 방과후 수업 상세보기 버튼 -->
           <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20">
             <div class="text-center">
               <button onclick="handleViewAfterSchoolSchedule()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors font-semibold">
                 📚 방과후 수업 상세보기 →
               </button>
             </div>
           </div>
         </div>
       </div>
     </header>

    <!-- 검색 -->
    <div class="search-container mb-6">
      <div class="flex items-center gap-2">
        <i data-lucide="search" class="w-5 h-5 text-gray-400"></i>
        <input id="searchInput" type="text" class="search-input" placeholder="수업 내용, 시험 정보, 공지사항 등을 검색해보세요..." />
      </div>
    </div>

    <!-- 액션 버튼 (인-모드로 열고, 모달 상단에 '새 창으로 열기' 있음) -->
    <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-w-6xl mx-auto searchable" data-search-text="OT 자료 자기평가 평균맞히기 큰수의법칙 실험기 동전던지기 시뮬레이션">


      <button class="action-tile tile-blue" onclick="handleViewOTMaterial()" aria-label="OT 자료 열기">
        <div class="text-3xl mb-2">📚</div>
        <h3 class="text-xl font-extrabold">OT 자료</h3>
        <p class="opacity-90">수업 소개 및 규칙</p>
      </button>

      <button class="action-tile tile-purple" onclick="handleViewSelfEvaluation()" aria-label="자기평가 결과 열기">
        <div class="text-3xl mb-2">📊</div>
        <h3 class="text-xl font-extrabold">자기평가 결과</h3>
        <p class="opacity-90">1학기 학생 의견 분석</p>
      </button>

      <button class="action-tile tile-orange" onclick="handleViewGameResult()" aria-label="평균 맞히기 게임 결과 열기">
        <div class="text-3xl mb-2">🎯</div>
        <h3 class="text-xl font-extrabold">평균 맞히기 게임</h3>
        <p class="opacity-90">통계적 추정 능력 측정</p>
      </button>

      <button class="action-tile tile-green" onclick="handleViewLawOfLargeNumbers()" aria-label="큰수의 법칙 실험기 열기">
        <div class="text-3xl mb-2">🎲</div>
        <h3 class="text-xl font-extrabold">큰수의 법칙 실험기</h3>
        <p class="opacity-90">주사위 던지기 시뮬레이션</p>
      </button>

      <button class="action-tile tile-indigo" onclick="handleViewBinormal()" aria-label="이항분포와 정규분포 비교 열기">
        <div class="text-3xl mb-2">📊</div>
        <h3 class="text-xl font-extrabold">이항↔정규 분포 비교</h3>
        <p class="opacity-90">이항분포의 정규근사 시뮬레이션</p>
      </button>

      <button class="action-tile tile-purple" onclick="handleViewStatisticalThinking()" aria-label="통계적 사고와 이상치 분석 열기">
        <div class="text-3xl mb-2">🎯</div>
        <h3 class="text-xl font-extrabold">통계적 사고와 이상치</h3>
        <p class="opacity-90">이상치 탐지 방법 비교 분석</p>
      </button>
    </section>

    <!-- 평가 방법 -->
    <section class="card mt-6 searchable" data-search-text="평가 방법 중간고사 기말고사 수행평가 과정평가 탐구발표">
      <h3 class="text-2xl font-extrabold flex items-center gap-2 mb-4">
        <i data-lucide="clipboard-list" class="w-6 h-6"></i> 📊 평가 방법
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200/50 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 relative overflow-hidden">
          <div class="absolute inset-0 bg-gradient-to-br from-blue-400/10 to-transparent"></div>
          <div class="relative z-10">
            <div class="text-4xl mb-3">📝</div>
            <h4 class="font-black text-blue-800 mb-2 text-lg">중간고사</h4>
            <p class="text-blue-700 text-2xl font-black mb-1">30%</p>
            <p class="text-blue-600 text-sm font-semibold bg-blue-200/50 px-3 py-1 rounded-full">9월 30일(화) 1교시</p>
          </div>
        </div>

        <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200/50 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 relative overflow-hidden">
          <div class="absolute inset-0 bg-gradient-to-br from-green-400/10 to-transparent"></div>
          <div class="relative z-10">
            <div class="text-4xl mb-3">📝</div>
            <h4 class="font-black text-green-800 mb-2 text-lg">기말고사</h4>
            <p class="text-green-700 text-2xl font-black mb-1">30%</p>
            <p class="text-green-600 text-sm font-semibold bg-green-200/50 px-3 py-1 rounded-full">12월 11일~17일</p>
          </div>
        </div>

        <div class="text-center p-6 rounded-2xl bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200/50 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 relative overflow-hidden md:col-span-2 lg:col-span-1">
          <div class="absolute inset-0 bg-gradient-to-br from-purple-400/10 to-transparent"></div>
          <div class="relative z-10">
            <div class="text-4xl mb-3">🎯</div>
            <h4 class="font-black text-purple-800 mb-2 text-lg">수행평가</h4>
            <p class="text-purple-700 text-2xl font-black mb-3">40%</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="rounded-xl p-3 bg-white/80 backdrop-blur-sm border border-purple-200/50">
                <p class="font-bold text-purple-700 text-sm">📋 단계별 과정평가</p>
                <p class="text-purple-600 text-xs font-semibold">과정평가 1, 2 (30%)</p>
              </div>
              <div class="rounded-xl p-3 bg-white/80 backdrop-blur-sm border border-purple-200/50">
                <p class="font-bold text-purple-700 text-sm">🎤 주제탐구발표</p>
                <p class="text-purple-600 text-xs font-semibold">자료 제출 (10%)</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 시험 정보 -->
    <section class="card mt-6 searchable" data-search-text="시험 정보 중간고사 기말고사 시험 기간 범위 통계적 추정 확률분포">
      <h3 class="text-2xl font-extrabold flex items-center gap-2 mb-4">
        <i data-lucide="calendar-days" class="w-6 h-6"></i> 📅 시험 정보
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200/50 shadow-xl transition-all duration-300 hover:shadow-2xl hover:scale-[1.02]">
          <div class="absolute inset-0 bg-gradient-to-br from-blue-400/10 via-transparent to-blue-600/5"></div>
          <div class="relative z-10 p-8">
            <div class="flex items-center gap-3 mb-4">
              <div class="p-2 bg-blue-200/50 rounded-lg">
                <i data-lucide="calendar" class="w-6 h-6 text-blue-700"></i>
              </div>
              <h4 class="text-2xl font-black text-blue-800">중간고사</h4>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center p-3 bg-white/60 rounded-xl backdrop-blur-sm border border-blue-200/30">
                <span class="font-bold text-blue-800">시험 기간</span>
                <span class="text-blue-700 font-semibold">9월 25일 ~ 10월 2일</span>
              </div>
              <div class="flex justify-between items-center p-3 bg-blue-200/40 rounded-xl backdrop-blur-sm border border-blue-300/50">
                <span class="font-bold text-blue-800">시험 일시</span>
                <span class="text-blue-700 font-bold">9월 30일(화) 1교시</span>
              </div>
              <div class="flex justify-between items-center p-3 bg-white/60 rounded-xl backdrop-blur-sm border border-blue-200/30">
                <span class="font-bold text-blue-800">시험 시간</span>
                <span class="text-blue-700 font-semibold">50분</span>
              </div>
              <div class="p-3 bg-gradient-to-r from-blue-200/50 to-blue-300/30 rounded-xl border border-blue-300/50">
                <div class="text-center">
                  <span class="font-bold text-blue-800 text-sm">시험 범위</span>
                  <p class="text-blue-700 font-bold mt-1">Ⅲ-1. 확률분포</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="relative overflow-hidden rounded-2xl bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200/50 shadow-xl transition-all duration-300 hover:shadow-2xl hover:scale-[1.02]">
          <div class="absolute inset-0 bg-gradient-to-br from-green-400/10 via-transparent to-green-600/5"></div>
          <div class="relative z-10 p-8">
            <div class="flex items-center gap-3 mb-4">
              <div class="p-2 bg-green-200/50 rounded-lg">
                <i data-lucide="calendar" class="w-6 h-6 text-green-700"></i>
              </div>
              <h4 class="text-2xl font-black text-green-800">기말고사</h4>
            </div>
            <div class="space-y-3">
              <div class="flex justify-between items-center p-3 bg-white/60 rounded-xl backdrop-blur-sm border border-green-200/30">
                <span class="font-bold text-green-800">시험 기간</span>
                <span class="text-green-700 font-semibold">12월 11일 ~ 17일</span>
              </div>
              <div class="flex justify-between items-center p-3 bg-white/60 rounded-xl backdrop-blur-sm border border-green-200/30">
                <span class="font-bold text-green-800">시험 시간</span>
                <span class="text-green-700 font-semibold">50분</span>
              </div>
              <div class="p-3 bg-gradient-to-r from-green-200/50 to-green-300/30 rounded-xl border border-green-300/50">
                <div class="text-center">
                  <span class="font-bold text-green-800 text-sm">시험 범위</span>
                  <p class="text-green-700 font-bold mt-1">Ⅲ-1. 확률분포+ Ⅲ-2. 통계적 추정</p>
                </div>
              </div>
              <div class="flex justify-between items-center p-3 bg-orange-100/60 rounded-xl backdrop-blur-sm border border-orange-200/50">
                <span class="font-bold text-orange-800">특이사항</span>
                <span class="text-orange-700 font-bold">평가원 기출문제 포함</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 공지사항 -->
    <section class="card mt-6 searchable" data-search-text="공지 교재 준비 수행평가 발표 권장 수능 출제 비중 안내">
      <h3 class="text-2xl font-extrabold flex items-center gap-2 mb-4">
        <i data-lucide="megaphone" class="w-6 h-6"></i> 📢 공지사항
      </h3>

      <div class="space-y-4">
        <article class="relative overflow-hidden rounded-2xl bg-gradient-to-r from-blue-50 to-blue-100 border-l-4 border-blue-500 p-6 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02]">
          <div class="absolute inset-0 bg-gradient-to-r from-blue-400/5 to-transparent"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-blue-200/50 rounded-lg">
                <span class="text-xl">📚</span>
              </div>
              <h4 class="font-black text-blue-800 text-lg">교재 준비 안내</h4>
            </div>
            <div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-blue-200/50">
              <p class="text-blue-800 font-semibold">주교재: 확률과 통계 (금성출판사)</p>
              <p class="text-blue-700 font-medium mt-1">부교재: EBS 수능특강 확률과 통계</p>
            </div>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl bg-gradient-to-r from-green-50 to-green-100 border-l-4 border-green-500 p-6 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02]">
          <div class="absolute inset-0 bg-gradient-to-r from-green-400/5 to-transparent"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-green-200/50 rounded-lg">
                <span class="text-xl">🎯</span>
              </div>
              <h4 class="font-black text-green-800 text-lg">수행평가 안내</h4>
            </div>
            <div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-green-200/50">
              <p class="text-green-800 font-semibold">주제탐구발표 자료 제출: 한글 파일 2쪽 이상</p>
              <div class="mt-2 inline-block bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-bold">
                ⚠️ 제출기한 초과 시 1일당 2점 감점
              </div>
            </div>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl bg-gradient-to-r from-purple-50 to-purple-100 border-l-4 border-purple-500 p-6 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02]">
          <div class="absolute inset-0 bg-gradient-to-r from-purple-400/5 to-transparent"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-purple-200/50 rounded-lg">
                <span class="text-xl">🏆</span>
              </div>
              <h4 class="font-black text-purple-800 text-lg">발표 권장사항</h4>
            </div>
            <div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-purple-200/50">
              <p class="text-purple-800 font-semibold">교과서 문제 풀이, 증명 발표 시 세특 기재 가능</p>
              <div class="mt-2 inline-block bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-bold">
                ✨ 필수는 아님, 적극 권장
              </div>
            </div>
          </div>
        </article>

        <article class="relative overflow-hidden rounded-2xl bg-gradient-to-r from-orange-50 to-orange-100 border-l-4 border-orange-500 p-6 shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-[1.02]">
          <div class="absolute inset-0 bg-gradient-to-r from-orange-400/5 to-transparent"></div>
          <div class="relative z-10">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-orange-200/50 rounded-lg">
                <span class="text-xl">📊</span>
              </div>
              <h4 class="font-black text-orange-800 text-lg">수능 출제 비중</h4>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-orange-200/50">
                <p class="text-orange-800 font-bold text-center">공통과목</p>
                <p class="text-orange-700 font-semibold text-center mt-1">22문항 (74점)</p>
              </div>
              <div class="bg-white/60 backdrop-blur-sm rounded-xl p-4 border border-orange-200/50">
                <p class="text-orange-800 font-bold text-center">선택과목</p>
                <p class="text-orange-700 font-semibold text-center mt-1">8문항 (26점)</p>
                <p class="text-orange-600 font-medium text-center text-xs mt-1">확률과 통계/미적분/기하</p>
              </div>
            </div>
          </div>
        </article>
      </div>
    </section>
  </div>

  <!-- 인-모드 iframe 모달 -->
  <div id="iframeContainer" class="iframe-container" aria-hidden="true">
    <div class="iframe-modal">
      <div class="iframe-header">
        <h2 id="iframeTitle" class="iframe-title">문서</h2>
        <div class="iframe-actions">
          <button type="button" id="openNewTabBtn" class="btn-primary">새 창으로 열기</button>
          <button type="button" id="closeIframeBtn" class="btn-close" aria-label="닫기">&times;</button>
        </div>
      </div>
      <div class="iframe-body">
        <iframe id="contentFrame" title="내장 문서 뷰어" allow="clipboard-read; clipboard-write" referrerpolicy="no-referrer"></iframe>
      </div>
    </div>
  </div>

  <script>
    // 아이콘 1회 초기화
    lucide.createIcons();

    // 다크모드 토글
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    
    // 저장된 테마 불러오기
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
      body.classList.add('dark');
      themeToggle.textContent = '☀️';
    }
    
    // 테마 토글 함수
    function toggleTheme() {
      body.classList.toggle('dark');
      const isDark = body.classList.contains('dark');
      
      if (isDark) {
        themeToggle.textContent = '☀️';
        localStorage.setItem('theme', 'dark');
      } else {
        themeToggle.textContent = '🌙';
        localStorage.setItem('theme', 'light');
      }
    }
    
    themeToggle.addEventListener('click', toggleTheme);

    // 상단 이동 버튼 기능
    const scrollToTopBtn = document.getElementById('scrollToTop');
    
    // 스크롤 감지
    window.addEventListener('scroll', () => {
      if (window.pageYOffset > 300) {
        scrollToTopBtn.classList.add('visible');
      } else {
        scrollToTopBtn.classList.remove('visible');
      }
    });
    
    // 상단 이동 기능
    scrollToTopBtn.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });

    // 검색: 섹션 단위 필터링
    const searchInput = document.getElementById('searchInput');
    const searchable = Array.from(document.querySelectorAll('.searchable'));
    searchInput.addEventListener('input', function(){
      const q = this.value.trim().toLowerCase();
      searchable.forEach(sec => {
        const hay = (sec.getAttribute('data-search-text') || sec.textContent || '').toLowerCase();
        sec.classList.toggle('hidden', q && !hay.includes(q));
      });
    });

    // ===== 모달 요소 =====
    const iframeContainer = document.getElementById('iframeContainer');
    const iframeEl = document.getElementById('contentFrame');
    const iframeTitle = document.getElementById('iframeTitle');
    const closeBtn = document.getElementById('closeIframeBtn');
    const openNewTabBtn = document.getElementById('openNewTabBtn');

    // 스크롤바 폭 측정 (레이아웃 점프 방지)
    function getScrollbarWidth(){
      const outer = document.createElement('div');
      outer.style.visibility = 'hidden';
      outer.style.overflow = 'scroll';
      outer.style.width = '100px';
      document.body.appendChild(outer);
      const inner = document.createElement('div');
      inner.style.width = '100%';
      outer.appendChild(inner);
      const w = outer.offsetWidth - inner.offsetWidth;
      outer.remove();
      return w;
    }

    // 모달 열기 (인-모드)
    function showInIframe(url, title){
      const sbw = getScrollbarWidth();
      document.documentElement.style.overflow = 'hidden';
      if (sbw) document.body.style.paddingRight = `${sbw}px`;

      iframeTitle.textContent = title || '문서';
      iframeEl.src = url;

      iframeContainer.classList.add('is-open');
      iframeContainer.setAttribute('aria-hidden','false');

      setTimeout(()=> closeBtn && closeBtn.focus(), 0);
    }

    // 모달 닫기
    function closeIframe(){
      iframeContainer.classList.remove('is-open');
      iframeContainer.setAttribute('aria-hidden','true');
      iframeEl.src = ''; // 로딩/오디오 등 중단

      document.documentElement.style.overflow = '';
      document.body.style.paddingRight = '';
    }

    // 새 창으로 열기
    function openInNewTab(){
      if (iframeEl && iframeEl.src) {
        window.open(iframeEl.src, '_blank', 'noopener');
      }
    }

    // 이벤트 바인딩
    iframeContainer.addEventListener('click', (e)=>{
      if(e.target === iframeContainer){ closeIframe(); }
    });
    closeBtn.addEventListener('click', closeIframe);
    openNewTabBtn.addEventListener('click', openInNewTab);
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape' && iframeContainer.classList.contains('is-open')) closeIframe();
    });

    // 버튼 핸들러 (인-모드로 먼저 열기)
    function handleViewOTMaterial(){ showInIframe('./orientation.html', 'OT 자료'); }
    function handleViewSchedule(){ showInIframe('./schedule.html', '선생님 시간표'); }
    function handleViewSelfEvaluation(){ showInIframe('./self-evaluation.html', '자기평가 결과'); }
    function handleViewGameResult(){ showInIframe('./average-game-result.html', '평균 맞히기 게임 결과'); }
    function handleViewLawOfLargeNumbers(){ showInIframe('./law-of-large-numbers.html', '큰수의 법칙 실험기'); }
    function handleViewBinormal(){ showInIframe('./binormal.html', '이항↔정규 분포 비교'); }
    function handleViewStatisticalThinking(){ showInIframe('./statistical_thinking_outlier.html', '통계적 사고와 이상치 분석'); }
    function handleViewAfterSchoolSchedule(){ showInIframe('./after-school-schedule.html', '방과후 수업 계획'); }
    

    // 전역 노출 (onclick용)
    window.handleViewOTMaterial = handleViewOTMaterial;
    window.handleViewSchedule = handleViewSchedule;
    window.handleViewSelfEvaluation = handleViewSelfEvaluation;
    window.handleViewGameResult = handleViewGameResult;
    window.handleViewLawOfLargeNumbers = handleViewLawOfLargeNumbers;
    window.handleViewBinormal = handleViewBinormal;
    window.handleViewStatisticalThinking = handleViewStatisticalThinking;
    window.handleViewAfterSchoolSchedule = handleViewAfterSchoolSchedule;
  </script>
</body>
</html>
